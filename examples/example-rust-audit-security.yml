name: Security Audit
# This workflow uses rustsec/audit-check to check for security vulnerabilities
# On scheduled runs: automatically creates GitHub issues for findings
# On push/PR: creates status checks that fail when vulnerabilities are found

on:
  schedule:
    # Run every Monday at 9 AM UTC
    - cron: '0 9 * * 1'
  push:
    branches: [main]
    paths:
      - '**/Cargo.toml'
      - '**/Cargo.lock'
  workflow_dispatch: # Allow manual runs

permissions: # these permissions are required for the workflow to run
  contents: read  # Required to checkout the repository
  issues: write   # Required to create issues (scheduled runs)
  checks: write   # Required to create status checks (push/PR)

jobs:
  security-audit:
    uses: init4tech/actions/.github/workflows/rust-audit-security.yml@main
    # Optional: ignore specific advisories
    # with:
    #   ignore-advisories: 'RUSTSEC-2020-0071,RUSTSEC-2021-0001'
    # Optional: for monorepos or non-root projects
    #   working-directory: './packages/api'
